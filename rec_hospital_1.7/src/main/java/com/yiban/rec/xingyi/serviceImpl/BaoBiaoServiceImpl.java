package com.yiban.rec.xingyi.serviceImpl;

import com.yiban.rec.service.base.BaseOprService;
import com.yiban.rec.xingyi.service.BaoBiaoService;
import java.util.List;
import java.util.Map;
import org.springframework.data.domain.PageRequest;
import org.springframework.stereotype.Service;

@Service
public class BaoBiaoServiceImpl extends BaseOprService implements BaoBiaoService {
  public List<Map<String, Object>> getList(PageRequest pageRequest, String startDate, String endDate) {
    StringBuffer sql = new StringBuffer();
    sql.append("SELECT DATE,cashier,SUM(guahaoweixinPayAmount) guahaoweixinPayAmount,SUM(guahaozhifubaoPayAmount) guahaozhifubaoPayAmount,SUM(guahaobankPayAmount) guahaobankPayAmount,\n SUM(jiaofeiweixinPayAmount) jiaofeiweixinPayAmount,SUM(jiaofeizhifubaoPayAmount) jiaofeizhifubaoPayAmount,SUM(jiaofeibankPayAmount) jiaofeibankPayAmount,\n SUM(zyyjjweixinPayAmount) zyyjjweixinPayAmount,SUM(zyyjjzhifubaoPayAmount) zyyjjzhifubaoPayAmount,SUM(zyyjjbankPayAmount) zyyjjbankPayAmount,\n SUM(zjweixinPayAmount) zjweixinPayAmount,SUM(zjzhifubaoPayAmount) zjzhifubaoPayAmount,SUM(zjbankPayAmount) zjbankPayAmount\n \n FROM \n (\n \nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,IFNULL(SUM(Pay_Amount),0) guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0451'\nAND pay_type='0249'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,IFNULL(SUM(Pay_Amount),0) guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0451'\nAND pay_type='0349'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,IFNULL(SUM(Pay_Amount),0) guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0451'\nAND pay_type='0149'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL \n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\nIFNULL(SUM(Pay_Amount),0) jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0551'\nAND pay_type='0249'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,IFNULL(SUM(Pay_Amount),0) jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0551'\nAND pay_type='0349'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,IFNULL(SUM(Pay_Amount),0) jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0551'\nAND pay_type='0149'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,IFNULL(SUM(Pay_Amount),0) zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0751'\nAND pay_type='0249'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,IFNULL(SUM(Pay_Amount),0) zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0751'\nAND pay_type='0349'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL \n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,IFNULL(SUM(Pay_Amount),0) zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE Pay_Business_Type='0751'\nAND pay_type='0149'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,IFNULL(SUM(Pay_Amount),0) zjweixinPayAmount,\n0 zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE (Pay_Business_Type='0751' OR Pay_Business_Type='0551' OR Pay_Business_Type='0451')\nAND pay_type='0249'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\nIFNULL(SUM(Pay_Amount),0) zjzhifubaoPayAmount,0 zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE (Pay_Business_Type='0751' OR Pay_Business_Type='0551' OR Pay_Business_Type='0451')\nAND pay_type='0349'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\nUNION ALL\n\nSELECT DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\") DATE,cashier,0 guahaoweixinPayAmount,0 guahaozhifubaoPayAmount,0 guahaobankPayAmount,\n0 jiaofeiweixinPayAmount,0 jiaofeizhifubaoPayAmount,0 jiaofeibankPayAmount,0 zyyjjweixinPayAmount,0 zyyjjzhifubaoPayAmount,0 zyyjjbankPayAmount,0 zjweixinPayAmount,\n0 zjzhifubaoPayAmount,IFNULL(SUM(Pay_Amount),0) zjbankPayAmount\nFROM t_rec_histransactionflow\nWHERE (Pay_Business_Type='0751' OR Pay_Business_Type='0551' OR Pay_Business_Type='0451')\nAND pay_type='0149'\nGROUP BY DATE_FORMAT(Trade_datatime,\"%Y-%m-%d\"),cashier\n\n\n) a\n\nWHERE 1=1\n\nAND DATE>='")
      
      .append(startDate).append("' ");
    sql.append("AND DATE<='").append(endDate).append("' ");
    sql.append("GROUP BY DATE,cashier\n\nORDER BY DATE DESC");
    this.logger.info("报表查询sql为："+ sql);
    return handleNativeSql(sql.toString(), new String[] { 
          "date", "cashier", "guahaoweixinPayAmount", "guahaozhifubaoPayAmount", "guahaobankPayAmount", "jiaofeiweixinPayAmount", "jiaofeizhifubaoPayAmount", "jiaofeibankPayAmount", "zyyjjweixinPayAmount", "zyyjjzhifubaoPayAmount", 
          "zyyjjbankPayAmount", "zjweixinPayAmount", "zjzhifubaoPayAmount", "zjbankPayAmount" });
  }
}
